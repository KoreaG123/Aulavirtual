<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Aula Virtual | Profesor</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="css/dashboard-style.css">
</head>
<body>

<!-- BotÃ³n hamburguesa -->
<button class="menu-toggle" id="menuToggle">â˜°</button>

<!-- Overlay -->
<div class="sidebar-overlay" id="sidebarOverlay"></div>

<div class="dashboard-container">
  <!-- SIDEBAR -->
  <aside class="sidebar">
    <div class="sidebar-header">
      <h2>ğŸ“ Aula Virtual</h2>
      <p id="userRole">Profesor</p>
    </div>

    <nav class="sidebar-nav">
      <a href="#" class="nav-item active" onclick="showSection('dashboard')">
        <span class="icon">ğŸ“Š</span> Dashboard
      </a>
      <a href="#" class="nav-item" onclick="showSection('courses')">
        <span class="icon">ğŸ“š</span> Mis Cursos
      </a>
      <a href="#" class="nav-item" onclick="showSection('planning')">
        <span class="icon">ğŸ“…</span> Planificar Clases
      </a>
      <a href="#" class="nav-item" onclick="showSection('students')">
        <span class="icon">ğŸ‘¥</span> Alumnos
      </a>
      <a href="#" class="nav-item" onclick="showSection('enrollments')">
        <span class="icon">ğŸ“</span> MatrÃ­culas
      </a>
      <a href="#" class="nav-item" onclick="showSection('exams')">
        <span class="icon">ğŸ“‹</span> ExÃ¡menes
      </a>
      <a href="#" class="nav-item" onclick="showSection('notifications')">
        <span class="icon">ğŸ””</span> Notificaciones
      </a>
    </nav>

    <div class="sidebar-footer">
      <button id="logoutBtn" class="logout-btn">Cerrar sesiÃ³n</button>
    </div>
  </aside>

  <!-- MAIN CONTENT -->
  <main class="main-content">
    <header class="top-bar">
      <h1 id="pageTitle">Mi Dashboard</h1>
      <div class="user-info">
        <span id="userName">Profesor</span>
        <div class="avatar">ğŸ‘¨â€ğŸ«</div>
      </div>
    </header>

    <div class="content-area" id="contentArea">
      <!-- Dashboard principal -->
      <div class="section-content active" id="dashboard">
        <div class="welcome-banner profesor">
          <h2>ğŸ‘‹ Bienvenido, Profesor</h2>
          <p>Gestiona tus cursos y alumnos</p>
        </div>

        <!-- MÃ©tricas del profesor -->
        <section class="metrics-section">
          <h3>ğŸ“Š Mis MÃ©tricas</h3>
          <div class="metrics-grid">
            <div class="metric-card">
              <div class="metric-icon">ğŸ“š</div>
              <div class="metric-info">
                <h4>8</h4>
                <p>Cursos Activos</p>
                <span class="metric-change">A mi cargo</span>
              </div>
            </div>
            <div class="metric-card">
              <div class="metric-icon">ğŸ‘¥</div>
              <div class="metric-info">
                <h4>124</h4>
                <p>Alumnos</p>
                <span class="metric-change positive">+12 este mes</span>
              </div>
            </div>
            <div class="metric-card">
              <div class="metric-icon">ğŸ“</div>
              <div class="metric-info">
                <h4>23</h4>
                <p>Tareas Pendientes</p>
                <span class="metric-change">Por revisar</span>
              </div>
            </div>
            <div class="metric-card">
              <div class="metric-icon">â­</div>
              <div class="metric-info">
                <h4>4.8</h4>
                <p>CalificaciÃ³n Promedio</p>
                <span class="metric-change positive">Excelente</span>
              </div>
            </div>
          </div>
        </section>

        <!-- Accesos RÃ¡pidos -->
        <section class="quick-access">
          <h3>âš¡ Accesos RÃ¡pidos</h3>
          <div class="quick-grid">
            <div class="quick-card" onclick="showSection('planning')">
              <span class="quick-icon">ğŸ“…</span>
              <h4>Planificar Clases</h4>
              <p>Administra tus cursos y horarios</p>
            </div>
            <div class="quick-card" onclick="showSection('students')">
              <span class="quick-icon">ğŸ‘¥</span>
              <h4>Mis Alumnos</h4>
              <p>Lista y progreso de estudiantes</p>
            </div>
            <div class="quick-card" onclick="showSection('exams')">
              <span class="quick-icon">ğŸ“‹</span>
              <h4>Crear Examen</h4>
              <p>Evaluaciones y calificaciones</p>
            </div>
            <div class="quick-card">
              <span class="quick-icon">ğŸ“Š</span>
              <h4>EstadÃ­sticas</h4>
              <p>Rendimiento de tus cursos</p>
            </div>
          </div>
        </section>

        <!-- Cursos recientes -->
        <section class="courses-section">
          <h3>ğŸ“š Mis Cursos Recientes</h3>
          <div class="courses-grid">
            <div class="course-card">
              <div class="course-header">
                <span class="course-icon">ğŸ’»</span>
                <span class="badge-active">Activo</span>
              </div>
              <h4>ProgramaciÃ³n Web</h4>
              <p>45 alumnos inscritos</p>
              <div class="course-footer">
                <span>PrÃ³xima clase: Lunes 10:00</span>
                <button class="btn-primary-sm">Ver Curso</button>
              </div>
            </div>

            <div class="course-card">
              <div class="course-header">
                <span class="course-icon">ğŸ¨</span>
                <span class="badge-active">Activo</span>
              </div>
              <h4>DiseÃ±o UI/UX</h4>
              <p>32 alumnos inscritos</p>
              <div class="course-footer">
                <span>PrÃ³xima clase: Martes 14:00</span>
                <button class="btn-primary-sm">Ver Curso</button>
              </div>
            </div>

            <div class="course-card">
              <div class="course-header">
                <span class="course-icon">ğŸ“Š</span>
                <span class="badge-active">Activo</span>
              </div>
              <h4>AnÃ¡lisis de Datos</h4>
              <p>28 alumnos inscritos</p>
              <div class="course-footer">
                <span>PrÃ³xima clase: MiÃ©rcoles 16:00</span>
                <button class="btn-primary-sm">Ver Curso</button>
              </div>
            </div>
          </div>
        </section>
      </div>

      <!-- Otras secciones -->
      <div class="section-content" id="courses">
        <h2>ğŸ“š Mis Cursos</h2>
        <p>Lista completa de cursos a tu cargo</p>
      </div>

      <div class="section-content" id="planning">
        <h2>ğŸ“… Planificar Clases</h2>
        <p>Calendario y planificaciÃ³n de clases</p>
      </div>

      <div class="section-content" id="students">
        <h2>ğŸ‘¥ Mis Alumnos</h2>
        <p>GestiÃ³n de estudiantes</p>
      </div>

      <div class="section-content" id="enrollments">
        <h2>ğŸ“ MatrÃ­culas</h2>
        <p>GestiÃ³n de inscripciones</p>
      </div>

      <div class="section-content" id="exams">
        <h2>ğŸ“‹ ExÃ¡menes</h2>
        <p>Crear y gestionar evaluaciones</p>
      </div>

      <div class="section-content" id="notifications">
        <h2>ğŸ”” Notificaciones</h2>
        <p>Centro de notificaciones</p>
      </div>
    </div>
  </main>
</div>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
<script src="js/firebase.js"></script>

<script>
// ===== CONTROL MENÃš MÃ“VIL =====
const menuToggle = document.getElementById('menuToggle');
const sidebar = document.querySelector('.sidebar');
const sidebarOverlay = document.getElementById('sidebarOverlay');

if (menuToggle && sidebar && sidebarOverlay) {
  menuToggle.addEventListener('click', () => {
    sidebar.classList.toggle('active');
    sidebarOverlay.classList.toggle('active');
  });

  sidebarOverlay.addEventListener('click', () => {
    sidebar.classList.remove('active');
    sidebarOverlay.classList.remove('active');
  });

  const navItems = document.querySelectorAll('.nav-item');
  navItems.forEach(item => {
    item.addEventListener('click', () => {
      if (window.innerWidth <= 768) {
        sidebar.classList.remove('active');
        sidebarOverlay.classList.remove('active');
      }
    });
  });
}

// ===== FIREBASE AUTH =====
const logoutBtn = document.getElementById("logoutBtn");
const userName = document.getElementById("userName");
const pageTitle = document.getElementById("pageTitle");

logoutBtn.onclick = async () => {
  await firebase.auth().signOut();
  location.href = "index.html";
};

firebase.auth().onAuthStateChanged(async user => {
  if (!user) return location.href = "index.html";
  
  const db = firebase.firestore();
  const doc = await db.collection("users").doc(user.uid).get();
  
  if (!doc.exists || doc.data().role !== "profesor") {
    alert("Acceso denegado");
    return location.href = "index.html";
  }

  userName.textContent = user.displayName || user.email;
});

function showSection(sectionId) {
  document.querySelectorAll('.section-content').forEach(s => s.classList.remove('active'));
  document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
  
  document.getElementById(sectionId).classList.add('active');
  event.target.closest('.nav-item').classList.add('active');
  
  const titles = {
    dashboard: 'Mi Dashboard',
    courses: 'Mis Cursos',
    planning: 'Planificar Clases',
    students: 'Mis Alumnos',
    enrollments: 'MatrÃ­culas',
    exams: 'ExÃ¡menes',
    notifications: 'Notificaciones'
  };
  pageTitle.textContent = titles[sectionId] || 'Dashboard';
}
</script>

</body>
</html>
